[
    {
        "prompt": "\u5c06\u8868\u683c{r1} {r2}(\u8868\u5934\u5206\u522b\u4e3a{h1}, {h2})\u5408\u5e76\uff1a- \u8868\u5934\u53d6\u4e24\u4e2a\u8868\u683c\u8868\u5934\u7684\u5e76\u96c6\uff0c\u4fdd\u7559\u8868\u5934- \u6839\u636ekey '\u8eab\u4efd\u8bc1\u53f7'\u5408\u5e76\u3002- \u751f\u6210rows\uff1alist[list[str]]",
        "code": "def merge_tables_lambdai(r1: 'list', r2: 'list', h1: 'list', h2: 'list') -> 'list[list[str]]':\n    \"\"\"\n    \u5c06\u8868\u683c{r1} {r2}(\u8868\u5934\u5206\u522b\u4e3a{h1}, {h2})\u5408\u5e76\uff1a- \u8868\u5934\u53d6\u4e24\u4e2a\u8868\u683c\u8868\u5934\u7684\u5e76\u96c6\uff0c\u4fdd\u7559\u8868\u5934- \u6839\u636ekey '\u8eab\u4efd\u8bc1\u53f7'\u5408\u5e76\u3002- \u751f\u6210rows\uff1alist[list[str]]\n    \"\"\"\n    from collections import defaultdict\n    \n    # \u5408\u5e76\u8868\u5934\n    merged_headers = list(set(h1 + h2))\n    # \u786e\u4fdd'\u8eab\u4efd\u8bc1\u53f7'\u5728\u7b2c\u4e00\u4f4d\n    if '\u8eab\u4efd\u8bc1\u53f7' in merged_headers:\n        merged_headers.remove('\u8eab\u4efd\u8bc1\u53f7')\n        merged_headers.insert(0, '\u8eab\u4efd\u8bc1\u53f7')\n    \n    # \u521b\u5efa\u5b57\u5178\u5b58\u50a8\u6570\u636e\n    data_dict = defaultdict(dict)\n    \n    # \u5904\u7406\u7b2c\u4e00\u4e2a\u8868\u683c\n    id_index1 = h1.index('\u8eab\u4efd\u8bc1\u53f7')\n    for row in r1:\n        id_num = row[id_index1]\n        for i, header in enumerate(h1):\n            if header != '\u8eab\u4efd\u8bc1\u53f7':\n                data_dict[id_num][header] = row[i]\n    \n    # \u5904\u7406\u7b2c\u4e8c\u4e2a\u8868\u683c\n    id_index2 = h2.index('\u8eab\u4efd\u8bc1\u53f7')\n    for row in r2:\n        id_num = row[id_index2]\n        for i, header in enumerate(h2):\n            if header != '\u8eab\u4efd\u8bc1\u53f7':\n                data_dict[id_num][header] = row[i]\n    \n    # \u751f\u6210\u5408\u5e76\u540e\u7684\u884c\n    merged_rows = []\n    for id_num in data_dict:\n        row = [id_num]\n        for header in merged_headers[1:]:\n            row.append(data_dict[id_num].get(header, ''))\n        merged_rows.append(row)\n    \n    return merged_rows",
        "error": ""
    },
    {
        "prompt": "\u5c06\u8868\u683c{r1} {r2}(\u8868\u5934\u5206\u522b\u4e3a{h1}, {h2})\u5408\u5e76\uff1a- \u8868\u5934\u53d6\u4e24\u4e2a\u8868\u683c\u8868\u5934\u7684\u5e76\u96c6\uff0c\u4fdd\u7559\u8868\u5934- \u6839\u636ekey '\u8eab\u4efd\u8bc1\u53f7'\u5408\u5e76\u3002- \u751f\u6210rows\uff1alist[list[str]]",
        "code": "def merge_tables_lambdai(r1: 'list', r2: 'list', h1: 'list', h2: 'list') -> 'list[list[str]]':\n    \"\"\"\n    \u5c06\u8868\u683c{r1} {r2}(\u8868\u5934\u5206\u522b\u4e3a{h1}, {h2})\u5408\u5e76\uff1a\n    - \u8868\u5934\u53d6\u4e24\u4e2a\u8868\u683c\u8868\u5934\u7684\u5e76\u96c6\uff0c\u4fdd\u7559\u8868\u5934\n    - \u6839\u636ekey '\u8eab\u4efd\u8bc1\u53f7'\u5408\u5e76\u3002\n    - \u751f\u6210rows\uff1alist[list[str]] (\u5305\u542b\u8868\u5934\u884c)\n    \"\"\"\n    from collections import defaultdict\n    \n    # \u5408\u5e76\u8868\u5934\u5e76\u786e\u4fdd\u5305\u542b\u6240\u6709\u5fc5\u9700\u5b57\u6bb5\n    merged_headers = list(set(h1 + h2))\n    required_headers = ['\u8eab\u4efd\u8bc1\u53f7', '\u59d3\u540d', '\u5e74\u9f84', '\u4e13\u4e1a']\n    \n    # \u6dfb\u52a0\u7f3a\u5931\u7684\u5fc5\u9700\u5b57\u6bb5\n    for header in required_headers:\n        if header not in merged_headers:\n            merged_headers.append(header)\n    \n    # \u786e\u4fdd'\u8eab\u4efd\u8bc1\u53f7'\u5728\u7b2c\u4e00\u4f4d\n    if '\u8eab\u4efd\u8bc1\u53f7' in merged_headers:\n        merged_headers.remove('\u8eab\u4efd\u8bc1\u53f7')\n        merged_headers.insert(0, '\u8eab\u4efd\u8bc1\u53f7')\n    \n    # \u521b\u5efa\u5b57\u5178\u5b58\u50a8\u6570\u636e\n    data_dict = defaultdict(dict)\n    \n    # \u5904\u7406\u7b2c\u4e00\u4e2a\u8868\u683c\n    id_index1 = h1.index('\u8eab\u4efd\u8bc1\u53f7')\n    for row in r1:\n        id_num = row[id_index1]\n        for i, header in enumerate(h1):\n            if header != '\u8eab\u4efd\u8bc1\u53f7':\n                data_dict[id_num][header] = row[i]\n    \n    # \u5904\u7406\u7b2c\u4e8c\u4e2a\u8868\u683c\n    id_index2 = h2.index('\u8eab\u4efd\u8bc1\u53f7')\n    for row in r2:\n        id_num = row[id_index2]\n        for i, header in enumerate(h2):\n            if header != '\u8eab\u4efd\u8bc1\u53f7':\n                data_dict[id_num][header] = row[i]\n    \n    # \u751f\u6210\u5408\u5e76\u540e\u7684\u884c(\u5305\u542b\u8868\u5934)\n    merged_rows = [merged_headers]\n    for id_num in data_dict:\n        row = [id_num]\n        for header in merged_headers[1:]:\n            row.append(data_dict[id_num].get(header, ''))\n        merged_rows.append(row)\n    \n    return merged_rows",
        "error": ""
    }
]